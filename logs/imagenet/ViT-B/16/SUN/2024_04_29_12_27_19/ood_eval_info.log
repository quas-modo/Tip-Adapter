2024-04-29 12:27:19,636 : #########TRAIN_EVAL_INFO############
2024-04-29 12:27:19,642 : 
Running in-domain dataset configs.
2024-04-29 12:27:19,642 : {'root_path': '/home/nfs03/liyh/', 'seed': 3407, 'load_cache': True, 'load_pre_feat': True, 'search_hp': True, 'search_scale': [30, 30, 60], 'search_step': [200, 30, 40], 'init_beta': 1, 'init_alpha': 2, 'init_gamma': 0.1, 'eps': 0.001, 'training_feat_num': 256, 'training_free_feat_num': 256, 'w_training_free': [0.7, 0.3], 'w_training': [0.2, 0.8], 'dataset': 'imagenet', 'shots': 16, 'backbone': 'ViT-B/16', 'lr': 0.001, 'augment_epoch': 10, 'train_epoch': 20, 'data_section': 0, 'cache_dir': '/home/nfs03/zengtc/tip/caches/imagenet'}
2024-04-29 12:27:25,628 : Preparing ImageNet dataset.
2024-04-29 12:29:47,018 : Getting textual features as CLIP's classifier.
2024-04-29 12:30:03,419 : 
Constructing cache model by few-shot visual features and labels.
2024-04-29 12:30:03,451 : 
Loading visual features and labels from test set.
2024-04-29 12:30:03,480 : 
Running out-domain dataset configs.
2024-04-29 12:30:03,480 : {'root_path': '/home/nfs03/zengtc', 'seed': 3407, 'load_cache': False, 'load_pre_feat': False, 'dataset': 'SUN', 'backbone': 'ViT-B/16'}
2024-04-29 12:30:37,987 : **** pos test accuracy: 68.76. ****

2024-04-29 12:30:37,991 : **** neg test(-) accuracy: 0.00. ****

2024-04-29 12:30:37,994 : **** neg test(+) accuracy: 62.30. ****

2024-04-29 12:30:37,998 : **** dual test accuracy: 19.59. ****

2024-04-29 12:30:38,335 : **** Our's test pos auroc: 92.01, fpr: 40.79. ****

2024-04-29 12:30:38,701 : **** Our's test neg(-) auroc: 68.16, fpr: 83.15. ****

2024-04-29 12:30:39,006 : **** Our's test neg(+) auroc: 89.97, fpr: 50.21. ****

2024-04-29 12:30:39,364 : **** Our's test dual auroc: 80.01, fpr: 75.74. ****

2024-04-29 12:30:39,825 : **** Our's test dual-ours auroc : 93.70, fpr: 30.85. ****

2024-04-29 12:30:39,879 : Train Epoch: 0 / 20
2024-04-29 12:31:04,420 : LR: 0.000994, Acc: 0.6460 (10336.0/16000), Loss: 1.4211
2024-04-29 12:31:04,462 : **** Dual-F's neg test accuracy: 66.82. ****

2024-04-29 12:31:04,463 : Train Epoch: 1 / 20
2024-04-29 12:31:28,827 : LR: 0.000976, Acc: 0.6707 (10732.0/16000), Loss: 1.3203
2024-04-29 12:31:28,870 : **** Dual-F's neg test accuracy: 67.49. ****

2024-04-29 12:31:28,870 : Train Epoch: 2 / 20
2024-04-29 12:31:53,397 : LR: 0.000946, Acc: 0.6852 (10963.0/16000), Loss: 1.2610
2024-04-29 12:31:53,440 : **** Dual-F's neg test accuracy: 68.08. ****

2024-04-29 12:31:53,440 : Train Epoch: 3 / 20
2024-04-29 12:32:18,007 : LR: 0.000905, Acc: 0.6965 (11144.0/16000), Loss: 1.2210
2024-04-29 12:32:18,050 : **** Dual-F's neg test accuracy: 68.64. ****

2024-04-29 12:32:18,051 : Train Epoch: 4 / 20
2024-04-29 12:32:42,622 : LR: 0.000854, Acc: 0.7096 (11354.0/16000), Loss: 1.1803
2024-04-29 12:32:42,665 : **** Dual-F's neg test accuracy: 68.88. ****

2024-04-29 12:32:42,665 : Train Epoch: 5 / 20
2024-04-29 12:33:07,126 : LR: 0.000794, Acc: 0.7187 (11499.0/16000), Loss: 1.1394
2024-04-29 12:33:07,170 : **** Dual-F's neg test accuracy: 69.36. ****

2024-04-29 12:33:07,170 : Train Epoch: 6 / 20
2024-04-29 12:33:31,816 : LR: 0.000727, Acc: 0.7278 (11645.0/16000), Loss: 1.1030
2024-04-29 12:33:31,859 : **** Dual-F's neg test accuracy: 69.57. ****

2024-04-29 12:33:31,859 : Train Epoch: 7 / 20
2024-04-29 12:33:56,664 : LR: 0.000655, Acc: 0.7389 (11823.0/16000), Loss: 1.0739
2024-04-29 12:33:56,707 : **** Dual-F's neg test accuracy: 69.82. ****

2024-04-29 12:33:56,707 : Train Epoch: 8 / 20
2024-04-29 12:34:21,363 : LR: 0.000578, Acc: 0.7402 (11843.0/16000), Loss: 1.0553
2024-04-29 12:34:21,407 : **** Dual-F's neg test accuracy: 70.02. ****

2024-04-29 12:34:21,407 : Train Epoch: 9 / 20
2024-04-29 12:34:46,090 : LR: 0.000500, Acc: 0.7472 (11955.0/16000), Loss: 1.0291
2024-04-29 12:34:46,133 : **** Dual-F's neg test accuracy: 70.17. ****

2024-04-29 12:34:46,134 : Train Epoch: 10 / 20
2024-04-29 12:35:10,952 : LR: 0.000422, Acc: 0.7545 (12072.0/16000), Loss: 1.0083
2024-04-29 12:35:10,996 : **** Dual-F's neg test accuracy: 70.34. ****

2024-04-29 12:35:10,996 : Train Epoch: 11 / 20
2024-04-29 12:35:35,498 : LR: 0.000345, Acc: 0.7622 (12196.0/16000), Loss: 0.9883
2024-04-29 12:35:35,542 : **** Dual-F's neg test accuracy: 70.41. ****

2024-04-29 12:35:35,542 : Train Epoch: 12 / 20
2024-04-29 12:36:00,348 : LR: 0.000273, Acc: 0.7705 (12328.0/16000), Loss: 0.9632
2024-04-29 12:36:00,391 : **** Dual-F's neg test accuracy: 70.52. ****

2024-04-29 12:36:00,391 : Train Epoch: 13 / 20
2024-04-29 12:36:25,228 : LR: 0.000206, Acc: 0.7696 (12313.0/16000), Loss: 0.9643
2024-04-29 12:36:25,272 : **** Dual-F's neg test accuracy: 70.57. ****

2024-04-29 12:36:25,272 : Train Epoch: 14 / 20
2024-04-29 12:36:50,014 : LR: 0.000146, Acc: 0.7733 (12373.0/16000), Loss: 0.9511
2024-04-29 12:36:50,057 : **** Dual-F's neg test accuracy: 70.53. ****

2024-04-29 12:36:50,057 : Train Epoch: 15 / 20
2024-04-29 12:37:14,760 : LR: 0.000095, Acc: 0.7716 (12345.0/16000), Loss: 0.9498
2024-04-29 12:37:14,804 : **** Dual-F's neg test accuracy: 70.58. ****

2024-04-29 12:37:14,804 : Train Epoch: 16 / 20
2024-04-29 12:37:39,632 : LR: 0.000054, Acc: 0.7729 (12366.0/16000), Loss: 0.9443
2024-04-29 12:37:39,675 : **** Dual-F's neg test accuracy: 70.53. ****

2024-04-29 12:37:39,675 : Train Epoch: 17 / 20
2024-04-29 12:38:04,673 : LR: 0.000024, Acc: 0.7731 (12369.0/16000), Loss: 0.9425
2024-04-29 12:38:04,716 : **** Dual-F's neg test accuracy: 70.53. ****

2024-04-29 12:38:04,717 : Train Epoch: 18 / 20
2024-04-29 12:38:29,400 : LR: 0.000006, Acc: 0.7790 (12464.0/16000), Loss: 0.9368
2024-04-29 12:38:29,442 : **** Dual-F's neg test accuracy: 70.54. ****

2024-04-29 12:38:29,443 : Train Epoch: 19 / 20
2024-04-29 12:38:54,404 : LR: 0.000000, Acc: 0.7768 (12429.0/16000), Loss: 0.9351
2024-04-29 12:38:54,447 : **** Dual-F's neg test accuracy: 70.54. ****

2024-04-29 12:38:54,447 : Train Epoch: 0 / 20
2024-04-29 12:39:20,142 : LR: 0.000994, Acc: 0.6912 (11059.0/16000), Loss: 1.1494
2024-04-29 12:39:20,184 : **** Dual-F's pos test accuracy: 70.17. ****

2024-04-29 12:39:20,185 : Train Epoch: 1 / 20
2024-04-29 12:39:45,882 : LR: 0.000976, Acc: 0.7073 (11316.0/16000), Loss: 1.0791
2024-04-29 12:39:45,925 : **** Dual-F's pos test accuracy: 70.68. ****

2024-04-29 12:39:45,925 : Train Epoch: 2 / 20
2024-04-29 12:40:11,462 : LR: 0.000946, Acc: 0.7151 (11442.0/16000), Loss: 1.0530
2024-04-29 12:40:11,505 : **** Dual-F's pos test accuracy: 70.93. ****

2024-04-29 12:40:11,505 : Train Epoch: 3 / 20
2024-04-29 12:40:37,199 : LR: 0.000905, Acc: 0.7209 (11535.0/16000), Loss: 1.0200
2024-04-29 12:40:37,242 : **** Dual-F's pos test accuracy: 71.24. ****

2024-04-29 12:40:37,242 : Train Epoch: 4 / 20
2024-04-29 12:41:02,645 : LR: 0.000854, Acc: 0.7308 (11692.0/16000), Loss: 0.9950
2024-04-29 12:41:02,688 : **** Dual-F's pos test accuracy: 71.38. ****

2024-04-29 12:41:02,688 : Train Epoch: 5 / 20
2024-04-29 12:41:28,316 : LR: 0.000794, Acc: 0.7371 (11793.0/16000), Loss: 0.9629
2024-04-29 12:41:28,358 : **** Dual-F's pos test accuracy: 71.51. ****

2024-04-29 12:41:28,359 : Train Epoch: 6 / 20
2024-04-29 12:41:53,814 : LR: 0.000727, Acc: 0.7412 (11860.0/16000), Loss: 0.9529
2024-04-29 12:41:53,856 : **** Dual-F's pos test accuracy: 71.67. ****

2024-04-29 12:41:53,856 : Train Epoch: 7 / 20
2024-04-29 12:42:19,456 : LR: 0.000655, Acc: 0.7498 (11996.0/16000), Loss: 0.9241
2024-04-29 12:42:19,499 : **** Dual-F's pos test accuracy: 71.77. ****

2024-04-29 12:42:19,499 : Train Epoch: 8 / 20
2024-04-29 12:42:44,974 : LR: 0.000578, Acc: 0.7536 (12058.0/16000), Loss: 0.9126
2024-04-29 12:42:45,017 : **** Dual-F's pos test accuracy: 71.90. ****

2024-04-29 12:42:45,017 : Train Epoch: 9 / 20
2024-04-29 12:43:10,621 : LR: 0.000500, Acc: 0.7567 (12107.0/16000), Loss: 0.8976
2024-04-29 12:43:10,665 : **** Dual-F's pos test accuracy: 71.92. ****

2024-04-29 12:43:10,665 : Train Epoch: 10 / 20
2024-04-29 12:43:36,280 : LR: 0.000422, Acc: 0.7631 (12210.0/16000), Loss: 0.8809
2024-04-29 12:43:36,323 : **** Dual-F's pos test accuracy: 72.01. ****

2024-04-29 12:43:36,323 : Train Epoch: 11 / 20
2024-04-29 12:44:01,915 : LR: 0.000345, Acc: 0.7680 (12288.0/16000), Loss: 0.8631
2024-04-29 12:44:01,958 : **** Dual-F's pos test accuracy: 72.05. ****

2024-04-29 12:44:01,958 : Train Epoch: 12 / 20
2024-04-29 12:44:27,326 : LR: 0.000273, Acc: 0.7686 (12298.0/16000), Loss: 0.8599
2024-04-29 12:44:27,369 : **** Dual-F's pos test accuracy: 72.13. ****

2024-04-29 12:44:27,369 : Train Epoch: 13 / 20
2024-04-29 12:44:52,920 : LR: 0.000206, Acc: 0.7752 (12403.0/16000), Loss: 0.8501
2024-04-29 12:44:52,963 : **** Dual-F's pos test accuracy: 72.30. ****

2024-04-29 12:44:52,964 : Train Epoch: 14 / 20
2024-04-29 12:45:18,477 : LR: 0.000146, Acc: 0.7721 (12353.0/16000), Loss: 0.8505
2024-04-29 12:45:18,521 : **** Dual-F's pos test accuracy: 72.24. ****

2024-04-29 12:45:18,521 : Train Epoch: 15 / 20
2024-04-29 12:45:43,948 : LR: 0.000095, Acc: 0.7776 (12441.0/16000), Loss: 0.8430
2024-04-29 12:45:43,991 : **** Dual-F's pos test accuracy: 72.25. ****

2024-04-29 12:45:43,991 : Train Epoch: 16 / 20
2024-04-29 12:46:09,390 : LR: 0.000054, Acc: 0.7754 (12407.0/16000), Loss: 0.8372
2024-04-29 12:46:09,433 : **** Dual-F's pos test accuracy: 72.27. ****

2024-04-29 12:46:09,434 : Train Epoch: 17 / 20
2024-04-29 12:46:34,844 : LR: 0.000024, Acc: 0.7752 (12403.0/16000), Loss: 0.8392
2024-04-29 12:46:34,887 : **** Dual-F's pos test accuracy: 72.29. ****

2024-04-29 12:46:34,888 : Train Epoch: 18 / 20
2024-04-29 12:47:00,357 : LR: 0.000006, Acc: 0.7789 (12463.0/16000), Loss: 0.8308
2024-04-29 12:47:00,400 : **** Dual-F's pos test accuracy: 72.28. ****

2024-04-29 12:47:00,400 : Train Epoch: 19 / 20
2024-04-29 12:47:25,780 : LR: 0.000000, Acc: 0.7778 (12444.0/16000), Loss: 0.8349
2024-04-29 12:47:25,823 : **** Dual-F's pos test accuracy: 72.28. ****

2024-04-29 12:47:25,906 : **** Dual's pos test accuracy: 72.28. ****

2024-04-29 12:47:25,910 : **** Dual's neg test accuracy: 70.54. ****

2024-04-29 12:47:25,913 : **** Dual's dual test accuracy: 71.92. ****

2024-04-29 12:47:26,302 : **** Our's test pos auroc: 91.56, fpr: 44.09. ****

2024-04-29 12:47:26,671 : **** Our's test neg auroc: 90.08, fpr: 48.35. ****

2024-04-29 12:47:27,040 : **** Our's test dual auroc: 91.16, fpr: 44.32. ****

2024-04-29 12:47:27,498 : **** Our's test dual-ours auroc : 93.45, fpr: 33.95. ****

