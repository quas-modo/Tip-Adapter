2024-04-28 17:34:53,524 : #########TRAIN_EVAL_INFO############
2024-04-28 17:34:53,533 : 
Running in-domain dataset configs.
2024-04-28 17:34:53,533 : {'root_path': '/home/nfs03/liyh/', 'seed': 3407, 'load_cache': True, 'load_pre_feat': True, 'search_hp': True, 'search_scale': [30, 30, 60], 'search_step': [200, 30, 40], 'init_beta': 1, 'init_alpha': 2, 'init_gamma': 0.1, 'eps': 0.001, 'training_feat_num': 256, 'training_free_feat_num': 256, 'w_training_free': [0.7, 0.3], 'w_training': [0.2, 0.8], 'dataset': 'imagenet', 'shots': 16, 'backbone': 'ViT-B/16', 'lr': 0.001, 'augment_epoch': 10, 'train_epoch': 20, 'data_section': 0, 'cache_dir': '/home/nfs03/zengtc/tip/caches/imagenet'}
2024-04-28 17:34:59,570 : Preparing ImageNet dataset.
2024-04-28 17:37:31,050 : Getting textual features as CLIP's classifier.
2024-04-28 17:37:47,429 : 
Constructing cache model by few-shot visual features and labels.
2024-04-28 17:37:47,558 : 
Loading visual features and labels from test set.
2024-04-28 17:37:47,590 : 
Running out-domain dataset configs.
2024-04-28 17:37:47,590 : {'root_path': '/home/nfs03/zengtc', 'seed': 3407, 'load_cache': False, 'load_pre_feat': False, 'dataset': 'SUN', 'backbone': 'ViT-B/16'}
2024-04-28 17:38:22,319 : **** pos test accuracy: 68.76. ****

2024-04-28 17:38:22,323 : **** neg test accuracy: 0.00. ****

2024-04-28 17:38:22,326 : **** neg test accuracy: 57.97. ****

2024-04-28 17:38:22,330 : **** dual test accuracy: 22.84. ****

2024-04-28 17:38:22,689 : **** Our's test pos auroc: 92.01, fpr: 40.79. ****

2024-04-28 17:38:23,059 : **** Our's test neg(-) auroc: 67.51, fpr: 83.46. ****

2024-04-28 17:38:23,366 : **** Our's test neg(+) auroc: 88.10, fpr: 60.50. ****

2024-04-28 17:38:23,757 : **** Our's test dual auroc: 77.62, fpr: 75.40. ****

2024-04-28 17:38:23,764 : **** our dual test accuracy: 59.79. ****

