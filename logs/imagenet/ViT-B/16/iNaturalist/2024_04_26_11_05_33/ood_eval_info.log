2024-04-26 11:05:33,426 : #########TRAIN_EVAL_INFO############
2024-04-26 11:05:33,495 : 
Running in-domain dataset configs.
2024-04-26 11:05:33,495 : {'root_path': '/home/nfs03/liyh/', 'seed': 3407, 'load_cache': True, 'load_pre_feat': True, 'search_hp': True, 'search_scale': [7, 7, 0.5], 'search_step': [200, 20, 5], 'init_beta': 1, 'init_alpha': 2, 'init_gamma': 0.1, 'eps': 0.001, 'training_feat_num': 256, 'training_free_feat_num': 256, 'w_training_free': [0.7, 0.3], 'w_training': [0.2, 0.8], 'dataset': 'imagenet', 'shots': 16, 'backbone': 'ViT-B/16', 'lr': 0.001, 'augment_epoch': 10, 'train_epoch': 20, 'data_section': 0, 'cache_dir': '/home/nfs03/zengtc/tip/caches/imagenet'}
2024-04-26 11:05:39,532 : Preparing ImageNet dataset.
2024-04-26 11:08:01,644 : Getting textual features as CLIP's classifier.
2024-04-26 11:08:17,693 : 
Constructing cache model by few-shot visual features and labels.
2024-04-26 11:08:17,790 : 
Loading visual features and labels from test set.
2024-04-26 11:08:17,820 : 
Running out-domain dataset configs.
2024-04-26 11:08:17,820 : {'root_path': '/home/nfs03/zengtc', 'seed': 3407, 'load_cache': False, 'load_pre_feat': False, 'dataset': 'iNaturalist', 'backbone': 'ViT-B/16'}
2024-04-26 11:08:45,954 : **** pos test accuracy: 69.42. ****

2024-04-26 11:08:45,958 : **** neg test accuracy: 61.30. ****

2024-04-26 11:08:45,962 : **** dual test accuracy: 67.50. ****

2024-04-26 11:08:46,340 : **** Our's test pos auroc: 91.72, fpr: 43.48. ****

2024-04-26 11:08:46,707 : **** Our's test neg auroc: 88.18, fpr: 61.66. ****

2024-04-26 11:08:47,076 : **** Our's test dual auroc: 90.80, fpr: 48.20. ****

