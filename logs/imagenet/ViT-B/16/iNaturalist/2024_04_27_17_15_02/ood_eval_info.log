2024-04-27 17:15:02,620 : #########TRAIN_EVAL_INFO############
2024-04-27 17:15:02,625 : 
Running in-domain dataset configs.
2024-04-27 17:15:02,625 : {'root_path': '/home/nfs03/liyh/', 'seed': 3407, 'load_cache': True, 'load_pre_feat': True, 'search_hp': True, 'search_scale': [7, 7, 0.5], 'search_step': [200, 20, 5], 'init_beta': 1, 'init_alpha': 2, 'init_gamma': 0.1, 'eps': 0.001, 'training_feat_num': 256, 'training_free_feat_num': 256, 'w_training_free': [0.7, 0.3], 'w_training': [0.2, 0.8], 'dataset': 'imagenet', 'shots': 16, 'backbone': 'ViT-B/16', 'lr': 0.001, 'augment_epoch': 10, 'train_epoch': 15, 'data_section': 0, 'cache_dir': '/home/nfs03/zengtc/tip/caches/imagenet'}
2024-04-27 17:15:08,622 : Preparing ImageNet dataset.
2024-04-27 17:17:28,464 : Getting textual features as CLIP's classifier.
2024-04-27 17:17:44,980 : 
Constructing cache model by few-shot visual features and labels.
2024-04-27 17:17:45,124 : 
Loading visual features and labels from test set.
2024-04-27 17:17:45,154 : 
Running out-domain dataset configs.
2024-04-27 17:17:45,154 : {'root_path': '/home/nfs03/zengtc', 'seed': 3407, 'load_cache': False, 'load_pre_feat': False, 'dataset': 'iNaturalist', 'backbone': 'ViT-B/16'}
2024-04-27 17:18:06,140 : **** pos test accuracy: 69.42. ****

2024-04-27 17:18:06,143 : **** neg test accuracy: 57.99. ****

2024-04-27 17:18:06,147 : **** dual test accuracy: 69.03. ****

2024-04-27 17:18:06,520 : **** Our's test pos auroc: 91.72, fpr: 43.48. ****

2024-04-27 17:18:06,887 : **** Our's test neg auroc: 85.33, fpr: 72.20. ****

2024-04-27 17:18:07,252 : **** Our's test dual auroc: 91.38, fpr: 44.93. ****

2024-04-27 17:18:07,259 : **** our dual test accuracy: 69.42. ****

2024-04-27 17:18:07,719 : **** Our's test dual-ours auroc : 92.21, fpr: 42.47. ****

2024-04-27 17:18:07,773 : Train Epoch: 0 / 15
2024-04-27 17:18:32,743 : LR: 0.000989, Acc: 0.6689 (10703.0/16000), Loss: 1.2944
2024-04-27 17:18:32,779 : **** Dual-F's neg test accuracy: 66.76. ****

2024-04-27 17:18:32,779 : Train Epoch: 1 / 15
2024-04-27 17:18:57,648 : LR: 0.000957, Acc: 0.7027 (11243.0/16000), Loss: 1.1594
2024-04-27 17:18:57,685 : **** Dual-F's neg test accuracy: 67.81. ****

2024-04-27 17:18:57,685 : Train Epoch: 2 / 15
2024-04-27 17:19:22,613 : LR: 0.000905, Acc: 0.7242 (11588.0/16000), Loss: 1.0856
2024-04-27 17:19:22,650 : **** Dual-F's neg test accuracy: 68.40. ****

2024-04-27 17:19:22,650 : Train Epoch: 3 / 15
2024-04-27 17:19:47,630 : LR: 0.000835, Acc: 0.7389 (11822.0/16000), Loss: 1.0335
2024-04-27 17:19:47,667 : **** Dual-F's neg test accuracy: 68.91. ****

2024-04-27 17:19:47,667 : Train Epoch: 4 / 15
2024-04-27 17:20:12,628 : LR: 0.000750, Acc: 0.7500 (12000.0/16000), Loss: 0.9896
2024-04-27 17:20:12,664 : **** Dual-F's neg test accuracy: 69.36. ****

2024-04-27 17:20:12,665 : Train Epoch: 5 / 15
2024-04-27 17:20:37,661 : LR: 0.000655, Acc: 0.7676 (12281.0/16000), Loss: 0.9462
2024-04-27 17:20:37,696 : **** Dual-F's neg test accuracy: 69.63. ****

2024-04-27 17:20:37,697 : Train Epoch: 6 / 15
2024-04-27 17:21:02,809 : LR: 0.000552, Acc: 0.7759 (12415.0/16000), Loss: 0.9134
2024-04-27 17:21:02,846 : **** Dual-F's neg test accuracy: 69.84. ****

2024-04-27 17:21:02,846 : Train Epoch: 7 / 15
2024-04-27 17:21:28,098 : LR: 0.000448, Acc: 0.7857 (12571.0/16000), Loss: 0.8833
2024-04-27 17:21:28,133 : **** Dual-F's neg test accuracy: 70.03. ****

2024-04-27 17:21:28,133 : Train Epoch: 8 / 15
2024-04-27 17:21:53,150 : LR: 0.000345, Acc: 0.7883 (12613.0/16000), Loss: 0.8694
2024-04-27 17:21:53,186 : **** Dual-F's neg test accuracy: 70.12. ****

2024-04-27 17:21:53,186 : Train Epoch: 9 / 15
2024-04-27 17:22:18,200 : LR: 0.000250, Acc: 0.7963 (12740.0/16000), Loss: 0.8505
2024-04-27 17:22:18,236 : **** Dual-F's neg test accuracy: 70.25. ****

2024-04-27 17:22:18,236 : Train Epoch: 10 / 15
2024-04-27 17:22:43,335 : LR: 0.000165, Acc: 0.7996 (12793.0/16000), Loss: 0.8376
2024-04-27 17:22:43,372 : **** Dual-F's neg test accuracy: 70.33. ****

2024-04-27 17:22:43,372 : Train Epoch: 11 / 15
2024-04-27 17:23:08,541 : LR: 0.000095, Acc: 0.8060 (12896.0/16000), Loss: 0.8243
2024-04-27 17:23:08,578 : **** Dual-F's neg test accuracy: 70.26. ****

2024-04-27 17:23:08,578 : Train Epoch: 12 / 15
2024-04-27 17:23:34,583 : LR: 0.000043, Acc: 0.8123 (12997.0/16000), Loss: 0.8079
2024-04-27 17:23:34,620 : **** Dual-F's neg test accuracy: 70.25. ****

2024-04-27 17:23:34,620 : Train Epoch: 13 / 15
2024-04-27 17:23:59,847 : LR: 0.000011, Acc: 0.8089 (12942.0/16000), Loss: 0.8170
2024-04-27 17:23:59,882 : **** Dual-F's neg test accuracy: 70.26. ****

2024-04-27 17:23:59,882 : Train Epoch: 14 / 15
2024-04-27 17:24:25,040 : LR: 0.000000, Acc: 0.8095 (12952.0/16000), Loss: 0.8134
2024-04-27 17:24:25,077 : **** Dual-F's neg test accuracy: 70.26. ****

2024-04-27 17:24:25,078 : Train Epoch: 0 / 15
2024-04-27 17:24:50,085 : LR: 0.000989, Acc: 0.7083 (11332.0/16000), Loss: 1.0740
2024-04-27 17:24:50,127 : **** Dual-F's pos test accuracy: 70.41. ****

2024-04-27 17:24:50,128 : Train Epoch: 1 / 15
2024-04-27 17:25:15,233 : LR: 0.000957, Acc: 0.7224 (11558.0/16000), Loss: 1.0241
2024-04-27 17:25:15,275 : **** Dual-F's pos test accuracy: 71.00. ****

2024-04-27 17:25:15,276 : Train Epoch: 2 / 15
2024-04-27 17:25:40,511 : LR: 0.000905, Acc: 0.7305 (11688.0/16000), Loss: 0.9921
2024-04-27 17:25:40,556 : **** Dual-F's pos test accuracy: 71.29. ****

2024-04-27 17:25:40,556 : Train Epoch: 3 / 15
2024-04-27 17:26:05,644 : LR: 0.000835, Acc: 0.7398 (11836.0/16000), Loss: 0.9618
2024-04-27 17:26:05,687 : **** Dual-F's pos test accuracy: 71.55. ****

2024-04-27 17:26:05,687 : Train Epoch: 4 / 15
2024-04-27 17:26:30,781 : LR: 0.000750, Acc: 0.7451 (11921.0/16000), Loss: 0.9391
2024-04-27 17:26:30,825 : **** Dual-F's pos test accuracy: 71.69. ****

2024-04-27 17:26:30,825 : Train Epoch: 5 / 15
2024-04-27 17:26:56,048 : LR: 0.000655, Acc: 0.7484 (11975.0/16000), Loss: 0.9344
2024-04-27 17:26:56,091 : **** Dual-F's pos test accuracy: 71.76. ****

2024-04-27 17:26:56,091 : Train Epoch: 6 / 15
2024-04-27 17:27:21,358 : LR: 0.000552, Acc: 0.7564 (12102.0/16000), Loss: 0.9122
2024-04-27 17:27:21,402 : **** Dual-F's pos test accuracy: 71.89. ****

2024-04-27 17:27:21,402 : Train Epoch: 7 / 15
2024-04-27 17:27:46,720 : LR: 0.000448, Acc: 0.7565 (12104.0/16000), Loss: 0.9011
2024-04-27 17:27:46,763 : **** Dual-F's pos test accuracy: 71.95. ****

2024-04-27 17:27:46,763 : Train Epoch: 8 / 15
2024-04-27 17:28:11,879 : LR: 0.000345, Acc: 0.7599 (12159.0/16000), Loss: 0.8864
2024-04-27 17:28:11,922 : **** Dual-F's pos test accuracy: 71.96. ****

2024-04-27 17:28:11,922 : Train Epoch: 9 / 15
2024-04-27 17:28:36,969 : LR: 0.000250, Acc: 0.7616 (12185.0/16000), Loss: 0.8793
2024-04-27 17:28:37,012 : **** Dual-F's pos test accuracy: 71.98. ****

2024-04-27 17:28:37,012 : Train Epoch: 10 / 15
2024-04-27 17:29:02,142 : LR: 0.000165, Acc: 0.7636 (12217.0/16000), Loss: 0.8641
2024-04-27 17:29:02,185 : **** Dual-F's pos test accuracy: 71.99. ****

2024-04-27 17:29:02,186 : Train Epoch: 11 / 15
2024-04-27 17:29:27,324 : LR: 0.000095, Acc: 0.7657 (12251.0/16000), Loss: 0.8741
2024-04-27 17:29:27,367 : **** Dual-F's pos test accuracy: 72.02. ****

2024-04-27 17:29:27,367 : Train Epoch: 12 / 15
2024-04-27 17:29:52,569 : LR: 0.000043, Acc: 0.7648 (12237.0/16000), Loss: 0.8635
2024-04-27 17:29:52,613 : **** Dual-F's pos test accuracy: 72.02. ****

2024-04-27 17:29:52,613 : Train Epoch: 13 / 15
2024-04-27 17:30:17,651 : LR: 0.000011, Acc: 0.7636 (12218.0/16000), Loss: 0.8692
2024-04-27 17:30:17,693 : **** Dual-F's pos test accuracy: 72.02. ****

2024-04-27 17:30:17,694 : Train Epoch: 14 / 15
2024-04-27 17:30:42,877 : LR: 0.000000, Acc: 0.7644 (12230.0/16000), Loss: 0.8680
2024-04-27 17:30:42,921 : **** Dual-F's pos test accuracy: 72.02. ****

2024-04-27 17:30:42,998 : **** Dual's pos test accuracy: 72.02. ****

2024-04-27 17:30:43,002 : **** Dual's neg test accuracy: 70.26. ****

2024-04-27 17:30:43,005 : **** Dual's dual test accuracy: 72.46. ****

2024-04-27 17:30:43,404 : **** Our's test pos auroc: 92.19, fpr: 40.50. ****

2024-04-27 17:30:43,773 : **** Our's test neg auroc: 100.00, fpr: 0.00. ****

2024-04-27 17:30:44,139 : **** Our's test dual auroc: 99.59, fpr: 1.55. ****

2024-04-27 17:30:44,608 : **** Our's test dual-ours auroc : 0.00, fpr: 100.00. ****

