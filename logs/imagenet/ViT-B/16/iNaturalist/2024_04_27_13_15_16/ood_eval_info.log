2024-04-27 13:15:16,248 : #########TRAIN_EVAL_INFO############
2024-04-27 13:15:16,252 : 
Running in-domain dataset configs.
2024-04-27 13:15:16,253 : {'root_path': '/home/nfs03/liyh/', 'seed': 3407, 'load_cache': True, 'load_pre_feat': True, 'search_hp': True, 'search_scale': [7, 7, 0.5], 'search_step': [200, 20, 5], 'init_beta': 1, 'init_alpha': 2, 'init_gamma': 0.1, 'eps': 0.001, 'training_feat_num': 256, 'training_free_feat_num': 256, 'w_training_free': [0.7, 0.3], 'w_training': [0.2, 0.8], 'dataset': 'imagenet', 'shots': 16, 'backbone': 'ViT-B/16', 'lr': 0.001, 'augment_epoch': 10, 'train_epoch': 20, 'data_section': 0, 'cache_dir': '/home/nfs03/zengtc/tip/caches/imagenet'}
2024-04-27 13:15:22,251 : Preparing ImageNet dataset.
2024-04-27 13:17:46,443 : Getting textual features as CLIP's classifier.
2024-04-27 13:18:02,510 : 
Constructing cache model by few-shot visual features and labels.
2024-04-27 13:18:02,632 : 
Loading visual features and labels from test set.
2024-04-27 13:18:02,661 : 
Running out-domain dataset configs.
2024-04-27 13:18:02,661 : {'root_path': '/home/nfs03/zengtc', 'seed': 3407, 'load_cache': False, 'load_pre_feat': False, 'dataset': 'iNaturalist', 'backbone': 'ViT-B/16'}
2024-04-27 13:18:24,008 : **** pos test accuracy: 69.42. ****

2024-04-27 13:18:24,011 : **** neg test accuracy: 57.99. ****

2024-04-27 13:18:24,015 : **** dual test accuracy: 69.03. ****

2024-04-27 13:18:24,388 : **** Our's test pos auroc: 91.72, fpr: 43.48. ****

2024-04-27 13:18:24,748 : **** Our's test neg auroc: 85.33, fpr: 72.20. ****

2024-04-27 13:18:25,109 : **** Our's test dual auroc: 91.38, fpr: 44.93. ****

2024-04-27 13:18:25,117 : **** our dual test accuracy: 69.42. ****

2024-04-27 13:18:25,571 : **** Our's test dual-ours auroc : 92.21, fpr: 42.47. ****

2024-04-27 13:18:25,627 : Train Epoch: 0 / 20
2024-04-27 13:18:50,525 : LR: 0.000994, Acc: 0.7108 (11373.0/16000), Loss: 1.0702
2024-04-27 13:18:50,525 : Train Epoch: 1 / 20
2024-04-27 13:19:15,488 : LR: 0.000976, Acc: 0.7214 (11542.0/16000), Loss: 1.0292
2024-04-27 13:19:15,488 : Train Epoch: 2 / 20
2024-04-27 13:19:40,842 : LR: 0.000946, Acc: 0.7303 (11685.0/16000), Loss: 0.9930
2024-04-27 13:19:40,843 : Train Epoch: 3 / 20
2024-04-27 13:20:06,176 : LR: 0.000905, Acc: 0.7359 (11775.0/16000), Loss: 0.9677
2024-04-27 13:20:06,176 : Train Epoch: 4 / 20
2024-04-27 13:20:31,065 : LR: 0.000854, Acc: 0.7460 (11936.0/16000), Loss: 0.9470
2024-04-27 13:20:31,066 : Train Epoch: 5 / 20
2024-04-27 13:20:56,067 : LR: 0.000794, Acc: 0.7506 (12010.0/16000), Loss: 0.9227
2024-04-27 13:20:56,067 : Train Epoch: 6 / 20
2024-04-27 13:21:21,121 : LR: 0.000727, Acc: 0.7575 (12120.0/16000), Loss: 0.9022
2024-04-27 13:21:21,122 : Train Epoch: 7 / 20
2024-04-27 13:21:46,599 : LR: 0.000655, Acc: 0.7601 (12162.0/16000), Loss: 0.8875
2024-04-27 13:21:46,599 : Train Epoch: 8 / 20
2024-04-27 13:22:11,733 : LR: 0.000578, Acc: 0.7603 (12165.0/16000), Loss: 0.8795
2024-04-27 13:22:11,733 : Train Epoch: 9 / 20
2024-04-27 13:22:36,799 : LR: 0.000500, Acc: 0.7646 (12234.0/16000), Loss: 0.8637
2024-04-27 13:22:36,800 : Train Epoch: 10 / 20
2024-04-27 13:23:01,835 : LR: 0.000422, Acc: 0.7718 (12349.0/16000), Loss: 0.8523
2024-04-27 13:23:01,835 : Train Epoch: 11 / 20
2024-04-27 13:23:26,811 : LR: 0.000345, Acc: 0.7724 (12358.0/16000), Loss: 0.8435
2024-04-27 13:23:26,812 : Train Epoch: 12 / 20
2024-04-27 13:23:52,022 : LR: 0.000273, Acc: 0.7786 (12458.0/16000), Loss: 0.8252
2024-04-27 13:23:52,023 : Train Epoch: 13 / 20
2024-04-27 13:24:17,257 : LR: 0.000206, Acc: 0.7761 (12418.0/16000), Loss: 0.8343
2024-04-27 13:24:17,258 : Train Epoch: 14 / 20
2024-04-27 13:24:53,178 : LR: 0.000146, Acc: 0.7793 (12469.0/16000), Loss: 0.8253
2024-04-27 13:24:53,179 : Train Epoch: 15 / 20
2024-04-27 13:25:18,054 : LR: 0.000095, Acc: 0.7776 (12442.0/16000), Loss: 0.8270
2024-04-27 13:25:18,055 : Train Epoch: 16 / 20
2024-04-27 13:59:06,175 : LR: 0.000054, Acc: 0.7796 (12473.0/16000), Loss: 0.8241
2024-04-27 13:59:06,175 : Train Epoch: 17 / 20
2024-04-27 13:59:46,210 : LR: 0.000024, Acc: 0.7774 (12439.0/16000), Loss: 0.8237
2024-04-27 13:59:46,210 : Train Epoch: 18 / 20
2024-04-27 14:00:11,103 : LR: 0.000006, Acc: 0.7789 (12463.0/16000), Loss: 0.8212
2024-04-27 14:00:11,103 : Train Epoch: 19 / 20
2024-04-27 14:00:36,167 : LR: 0.000000, Acc: 0.7807 (12491.0/16000), Loss: 0.8202
2024-04-27 14:00:36,167 : Train Epoch: 0 / 20
2024-04-27 14:01:01,558 : LR: 0.000994, Acc: 0.0000 (0.0/16000), Loss: 19.7004
2024-04-27 14:01:01,558 : Train Epoch: 1 / 20
2024-04-27 14:01:26,660 : LR: 0.000976, Acc: 0.0000 (0.0/16000), Loss: 16.7617
2024-04-27 14:01:26,661 : Train Epoch: 2 / 20
2024-04-27 14:01:51,735 : LR: 0.000946, Acc: 0.0000 (0.0/16000), Loss: 14.9113
2024-04-27 14:01:51,736 : Train Epoch: 3 / 20
2024-04-27 14:02:16,747 : LR: 0.000905, Acc: 0.0001 (1.0/16000), Loss: 13.5260
2024-04-27 14:02:16,748 : Train Epoch: 4 / 20
2024-04-27 14:02:41,646 : LR: 0.000854, Acc: 0.0000 (0.0/16000), Loss: 12.4253
2024-04-27 14:02:41,646 : Train Epoch: 5 / 20
2024-04-27 14:03:06,874 : LR: 0.000794, Acc: 0.0001 (2.0/16000), Loss: 11.5303
2024-04-27 14:03:06,874 : Train Epoch: 6 / 20
2024-04-27 14:03:31,891 : LR: 0.000727, Acc: 0.0007 (11.0/16000), Loss: 10.7510
2024-04-27 14:03:31,892 : Train Epoch: 7 / 20
