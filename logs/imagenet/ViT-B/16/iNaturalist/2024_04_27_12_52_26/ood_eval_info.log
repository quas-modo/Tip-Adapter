2024-04-27 12:52:26,756 : #########TRAIN_EVAL_INFO############
2024-04-27 12:52:26,767 : 
Running in-domain dataset configs.
2024-04-27 12:52:26,767 : {'root_path': '/home/nfs03/liyh/', 'seed': 3407, 'load_cache': True, 'load_pre_feat': True, 'search_hp': True, 'search_scale': [7, 7, 0.5], 'search_step': [200, 20, 5], 'init_beta': 1, 'init_alpha': 2, 'init_gamma': 0.1, 'eps': 0.001, 'training_feat_num': 256, 'training_free_feat_num': 256, 'w_training_free': [0.7, 0.3], 'w_training': [0.2, 0.8], 'dataset': 'imagenet', 'shots': 16, 'backbone': 'ViT-B/16', 'lr': 0.001, 'augment_epoch': 10, 'train_epoch': 20, 'data_section': 0, 'cache_dir': '/home/nfs03/zengtc/tip/caches/imagenet'}
2024-04-27 12:52:32,868 : Preparing ImageNet dataset.
2024-04-27 12:55:02,707 : Getting textual features as CLIP's classifier.
2024-04-27 12:55:18,924 : 
Constructing cache model by few-shot visual features and labels.
2024-04-27 12:55:19,041 : 
Loading visual features and labels from test set.
2024-04-27 12:55:19,069 : 
Running out-domain dataset configs.
2024-04-27 12:55:19,070 : {'root_path': '/home/nfs03/zengtc', 'seed': 3407, 'load_cache': False, 'load_pre_feat': False, 'dataset': 'iNaturalist', 'backbone': 'ViT-B/16'}
2024-04-27 12:55:40,417 : **** pos test accuracy: 69.42. ****

2024-04-27 12:55:40,421 : **** neg test accuracy: 57.99. ****

2024-04-27 12:55:40,424 : **** dual test accuracy: 69.03. ****

2024-04-27 12:55:40,768 : **** Our's test pos auroc: 91.72, fpr: 43.48. ****

2024-04-27 12:55:41,072 : **** Our's test neg auroc: 85.33, fpr: 72.20. ****

2024-04-27 12:55:41,441 : **** Our's test dual auroc: 91.38, fpr: 44.93. ****

2024-04-27 12:55:41,449 : **** our dual test accuracy: 69.42. ****

2024-04-27 12:55:41,904 : **** Our's test dual-ours auroc : 92.21, fpr: 42.47. ****

2024-04-27 12:55:41,961 : Train Epoch: 0 / 20
2024-04-27 12:56:06,877 : LR: 0.000994, Acc: 0.7108 (11373.0/16000), Loss: 1.0702
2024-04-27 12:56:06,878 : Train Epoch: 1 / 20
2024-04-27 12:56:31,662 : LR: 0.000976, Acc: 0.7214 (11542.0/16000), Loss: 1.0292
2024-04-27 12:56:31,662 : Train Epoch: 2 / 20
2024-04-27 12:56:56,535 : LR: 0.000946, Acc: 0.7303 (11685.0/16000), Loss: 0.9930
2024-04-27 12:56:56,535 : Train Epoch: 3 / 20
2024-04-27 12:57:21,495 : LR: 0.000905, Acc: 0.7359 (11775.0/16000), Loss: 0.9677
2024-04-27 12:57:21,495 : Train Epoch: 4 / 20
2024-04-27 12:57:46,937 : LR: 0.000854, Acc: 0.7460 (11936.0/16000), Loss: 0.9470
2024-04-27 12:57:46,937 : Train Epoch: 5 / 20
2024-04-27 12:58:12,391 : LR: 0.000794, Acc: 0.7506 (12010.0/16000), Loss: 0.9227
2024-04-27 12:58:12,391 : Train Epoch: 6 / 20
2024-04-27 12:58:37,584 : LR: 0.000727, Acc: 0.7575 (12120.0/16000), Loss: 0.9022
2024-04-27 12:58:37,585 : Train Epoch: 7 / 20
2024-04-27 12:59:02,728 : LR: 0.000655, Acc: 0.7601 (12162.0/16000), Loss: 0.8875
2024-04-27 12:59:02,728 : Train Epoch: 8 / 20
2024-04-27 12:59:27,731 : LR: 0.000578, Acc: 0.7603 (12165.0/16000), Loss: 0.8795
2024-04-27 12:59:27,732 : Train Epoch: 9 / 20
2024-04-27 12:59:52,673 : LR: 0.000500, Acc: 0.7646 (12234.0/16000), Loss: 0.8637
2024-04-27 12:59:52,673 : Train Epoch: 10 / 20
2024-04-27 13:00:17,849 : LR: 0.000422, Acc: 0.7718 (12349.0/16000), Loss: 0.8523
2024-04-27 13:00:17,849 : Train Epoch: 11 / 20
2024-04-27 13:00:42,936 : LR: 0.000345, Acc: 0.7724 (12358.0/16000), Loss: 0.8435
2024-04-27 13:00:42,937 : Train Epoch: 12 / 20
2024-04-27 13:01:08,124 : LR: 0.000273, Acc: 0.7786 (12458.0/16000), Loss: 0.8252
2024-04-27 13:01:08,124 : Train Epoch: 13 / 20
2024-04-27 13:01:33,363 : LR: 0.000206, Acc: 0.7761 (12418.0/16000), Loss: 0.8343
2024-04-27 13:01:33,363 : Train Epoch: 14 / 20
2024-04-27 13:01:58,380 : LR: 0.000146, Acc: 0.7793 (12469.0/16000), Loss: 0.8253
2024-04-27 13:01:58,380 : Train Epoch: 15 / 20
2024-04-27 13:02:23,426 : LR: 0.000095, Acc: 0.7776 (12442.0/16000), Loss: 0.8270
2024-04-27 13:02:23,426 : Train Epoch: 16 / 20
2024-04-27 13:02:48,626 : LR: 0.000054, Acc: 0.7796 (12473.0/16000), Loss: 0.8241
2024-04-27 13:02:48,627 : Train Epoch: 17 / 20
2024-04-27 13:03:13,769 : LR: 0.000024, Acc: 0.7774 (12439.0/16000), Loss: 0.8237
2024-04-27 13:03:13,769 : Train Epoch: 18 / 20
2024-04-27 13:03:38,850 : LR: 0.000006, Acc: 0.7789 (12463.0/16000), Loss: 0.8212
2024-04-27 13:03:38,850 : Train Epoch: 19 / 20
2024-04-27 13:04:03,951 : LR: 0.000000, Acc: 0.7807 (12491.0/16000), Loss: 0.8202
2024-04-27 13:04:03,951 : Train Epoch: 0 / 20
2024-04-27 13:04:29,053 : LR: 0.000994, Acc: 0.6776 (10841.0/16000), Loss: 1.2449
2024-04-27 13:04:29,053 : Train Epoch: 1 / 20
2024-04-27 13:04:54,286 : LR: 0.000976, Acc: 0.7257 (11611.0/16000), Loss: 1.0558
2024-04-27 13:04:54,286 : Train Epoch: 2 / 20
2024-04-27 13:05:19,499 : LR: 0.000946, Acc: 0.7519 (12030.0/16000), Loss: 0.9689
2024-04-27 13:05:19,500 : Train Epoch: 3 / 20
2024-04-27 13:05:44,519 : LR: 0.000905, Acc: 0.7739 (12382.0/16000), Loss: 0.8896
2024-04-27 13:05:44,519 : Train Epoch: 4 / 20
2024-04-27 13:06:09,426 : LR: 0.000854, Acc: 0.7934 (12694.0/16000), Loss: 0.8283
2024-04-27 13:06:09,426 : Train Epoch: 5 / 20
2024-04-27 13:06:34,654 : LR: 0.000794, Acc: 0.8081 (12929.0/16000), Loss: 0.7707
2024-04-27 13:06:34,654 : Train Epoch: 6 / 20
2024-04-27 13:06:59,736 : LR: 0.000727, Acc: 0.8171 (13073.0/16000), Loss: 0.7367
2024-04-27 13:06:59,736 : Train Epoch: 7 / 20
2024-04-27 13:07:24,822 : LR: 0.000655, Acc: 0.8344 (13351.0/16000), Loss: 0.6922
2024-04-27 13:07:24,823 : Train Epoch: 8 / 20
2024-04-27 13:07:49,916 : LR: 0.000578, Acc: 0.8413 (13460.0/16000), Loss: 0.6631
2024-04-27 13:07:49,917 : Train Epoch: 9 / 20
2024-04-27 13:08:14,982 : LR: 0.000500, Acc: 0.8496 (13593.0/16000), Loss: 0.6374
2024-04-27 13:08:14,983 : Train Epoch: 10 / 20
2024-04-27 13:08:40,226 : LR: 0.000422, Acc: 0.8550 (13680.0/16000), Loss: 0.6132
2024-04-27 13:08:40,226 : Train Epoch: 11 / 20
2024-04-27 13:09:05,223 : LR: 0.000345, Acc: 0.8655 (13848.0/16000), Loss: 0.5888
2024-04-27 13:09:05,223 : Train Epoch: 12 / 20
2024-04-27 13:09:30,271 : LR: 0.000273, Acc: 0.8707 (13931.0/16000), Loss: 0.5737
2024-04-27 13:09:30,271 : Train Epoch: 13 / 20
2024-04-27 13:09:55,348 : LR: 0.000206, Acc: 0.8746 (13994.0/16000), Loss: 0.5655
2024-04-27 13:09:55,348 : Train Epoch: 14 / 20
2024-04-27 13:10:20,441 : LR: 0.000146, Acc: 0.8766 (14026.0/16000), Loss: 0.5601
2024-04-27 13:10:20,441 : Train Epoch: 15 / 20
2024-04-27 13:10:45,641 : LR: 0.000095, Acc: 0.8804 (14086.0/16000), Loss: 0.5507
2024-04-27 13:10:45,642 : Train Epoch: 16 / 20
2024-04-27 13:11:10,638 : LR: 0.000054, Acc: 0.8819 (14111.0/16000), Loss: 0.5440
2024-04-27 13:11:10,639 : Train Epoch: 17 / 20
2024-04-27 13:11:35,655 : LR: 0.000024, Acc: 0.8807 (14091.0/16000), Loss: 0.5437
2024-04-27 13:11:35,656 : Train Epoch: 18 / 20
2024-04-27 13:12:00,746 : LR: 0.000006, Acc: 0.8826 (14121.0/16000), Loss: 0.5399
2024-04-27 13:12:00,747 : Train Epoch: 19 / 20
2024-04-27 13:12:25,642 : LR: 0.000000, Acc: 0.8829 (14126.0/16000), Loss: 0.5378
2024-04-27 13:12:25,719 : **** Dual's pos test accuracy: 72.35. ****

2024-04-27 13:12:25,722 : **** Dual's neg test accuracy: 0.00. ****

2024-04-27 13:12:25,726 : **** Dual's dual test accuracy: 73.17. ****

2024-04-27 13:12:26,088 : **** Our's test pos auroc: 92.34, fpr: 38.97. ****

2024-04-27 13:12:26,449 : **** Our's test neg auroc: 91.49, fpr: 47.82. ****

2024-04-27 13:12:26,811 : **** Our's test dual auroc: 93.53, fpr: 33.61. ****

2024-04-27 13:12:27,257 : **** Our's test dual-ours auroc : 92.13, fpr: 43.31. ****

