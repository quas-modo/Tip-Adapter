2024-04-27 16:21:48,712 : #########TRAIN_EVAL_INFO############
2024-04-27 16:21:48,729 : 
Running in-domain dataset configs.
2024-04-27 16:21:48,729 : {'root_path': '/home/nfs03/liyh/', 'seed': 3407, 'load_cache': True, 'load_pre_feat': True, 'search_hp': True, 'search_scale': [7, 7, 0.5], 'search_step': [200, 20, 5], 'init_beta': 1, 'init_alpha': 2, 'init_gamma': 0.1, 'eps': 0.001, 'training_feat_num': 256, 'training_free_feat_num': 256, 'w_training_free': [0.7, 0.3], 'w_training': [0.2, 0.8], 'dataset': 'imagenet', 'shots': 16, 'backbone': 'ViT-B/16', 'lr': 0.001, 'augment_epoch': 10, 'train_epoch': 20, 'data_section': 0, 'cache_dir': '/home/nfs03/zengtc/tip/caches/imagenet'}
2024-04-27 16:21:54,761 : Preparing ImageNet dataset.
2024-04-27 16:24:17,026 : Getting textual features as CLIP's classifier.
2024-04-27 16:24:33,195 : 
Constructing cache model by few-shot visual features and labels.
2024-04-27 16:24:33,313 : 
Loading visual features and labels from test set.
2024-04-27 16:24:33,344 : 
Running out-domain dataset configs.
2024-04-27 16:24:33,345 : {'root_path': '/home/nfs03/zengtc', 'seed': 3407, 'load_cache': False, 'load_pre_feat': False, 'dataset': 'iNaturalist', 'backbone': 'ViT-B/16'}
2024-04-27 16:24:54,403 : **** pos test accuracy: 69.42. ****

2024-04-27 16:24:54,407 : **** neg test accuracy: 57.99. ****

2024-04-27 16:24:54,410 : **** dual test accuracy: 69.03. ****

2024-04-27 16:24:54,785 : **** Our's test pos auroc: 91.72, fpr: 43.48. ****

2024-04-27 16:24:55,149 : **** Our's test neg auroc: 85.33, fpr: 72.20. ****

2024-04-27 16:24:55,516 : **** Our's test dual auroc: 91.38, fpr: 44.93. ****

2024-04-27 16:24:55,524 : **** our dual test accuracy: 69.42. ****

2024-04-27 16:24:55,986 : **** Our's test dual-ours auroc : 92.21, fpr: 42.47. ****

2024-04-27 16:24:56,045 : Train Epoch: 0 / 20
2024-04-27 16:25:20,977 : LR: 0.000994, Acc: 0.6689 (10703.0/16000), Loss: 1.2945
2024-04-27 16:25:20,977 : Train Epoch: 1 / 20
2024-04-27 16:25:45,944 : LR: 0.000976, Acc: 0.7026 (11241.0/16000), Loss: 1.1597
2024-04-27 16:25:45,945 : Train Epoch: 2 / 20
2024-04-27 16:26:10,963 : LR: 0.000946, Acc: 0.7242 (11587.0/16000), Loss: 1.0856
2024-04-27 16:26:10,963 : Train Epoch: 3 / 20
2024-04-27 16:26:35,996 : LR: 0.000905, Acc: 0.7384 (11814.0/16000), Loss: 1.0330
2024-04-27 16:26:35,997 : Train Epoch: 4 / 20
2024-04-27 16:27:01,193 : LR: 0.000854, Acc: 0.7498 (11996.0/16000), Loss: 0.9878
2024-04-27 16:27:01,194 : Train Epoch: 5 / 20
2024-04-27 16:27:26,317 : LR: 0.000794, Acc: 0.7681 (12289.0/16000), Loss: 0.9422
2024-04-27 16:27:26,317 : Train Epoch: 6 / 20
2024-04-27 16:27:51,537 : LR: 0.000727, Acc: 0.7759 (12415.0/16000), Loss: 0.9070
2024-04-27 16:27:51,538 : Train Epoch: 7 / 20
2024-04-27 16:28:16,840 : LR: 0.000655, Acc: 0.7874 (12598.0/16000), Loss: 0.8732
2024-04-27 16:28:16,841 : Train Epoch: 8 / 20
2024-04-27 16:28:42,004 : LR: 0.000578, Acc: 0.7907 (12651.0/16000), Loss: 0.8541
2024-04-27 16:28:42,005 : Train Epoch: 9 / 20
2024-04-27 16:29:07,160 : LR: 0.000500, Acc: 0.7997 (12795.0/16000), Loss: 0.8302
2024-04-27 16:29:07,160 : Train Epoch: 10 / 20
2024-04-27 16:29:32,227 : LR: 0.000422, Acc: 0.8055 (12888.0/16000), Loss: 0.8111
2024-04-27 16:29:32,227 : Train Epoch: 11 / 20
2024-04-27 16:29:57,195 : LR: 0.000345, Acc: 0.8140 (13024.0/16000), Loss: 0.7906
2024-04-27 16:29:57,196 : Train Epoch: 12 / 20
2024-04-27 16:30:22,434 : LR: 0.000273, Acc: 0.8221 (13153.0/16000), Loss: 0.7665
2024-04-27 16:30:22,434 : Train Epoch: 13 / 20
2024-04-27 16:30:47,887 : LR: 0.000206, Acc: 0.8233 (13173.0/16000), Loss: 0.7676
2024-04-27 16:30:47,888 : Train Epoch: 14 / 20
2024-04-27 16:31:13,085 : LR: 0.000146, Acc: 0.8253 (13205.0/16000), Loss: 0.7565
2024-04-27 16:31:13,085 : Train Epoch: 15 / 20
