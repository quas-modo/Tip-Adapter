2024-04-28 06:16:20,809 : #########TRAIN_EVAL_INFO############
2024-04-28 06:16:20,813 : 
Running in-domain dataset configs.
2024-04-28 06:16:20,813 : {'root_path': '/home/nfs03/liyh/', 'seed': 3407, 'load_cache': True, 'load_pre_feat': True, 'search_hp': True, 'search_scale': [7, 7, 0.5], 'search_step': [200, 20, 5], 'init_beta': 1, 'init_alpha': 2, 'init_gamma': 0.1, 'eps': 0.001, 'training_feat_num': 256, 'training_free_feat_num': 256, 'w_training_free': [0.7, 0.3], 'w_training': [0.2, 0.8], 'dataset': 'imagenet', 'shots': 16, 'backbone': 'ViT-B/16', 'lr': 0.001, 'augment_epoch': 10, 'train_epoch': 20, 'data_section': 0, 'cache_dir': '/home/nfs03/zengtc/tip/caches/imagenet'}
2024-04-28 06:16:26,886 : Preparing ImageNet dataset.
2024-04-28 06:18:50,454 : Getting textual features as CLIP's classifier.
2024-04-28 06:19:06,833 : 
Constructing cache model by few-shot visual features and labels.
2024-04-28 06:19:06,965 : 
Loading visual features and labels from test set.
2024-04-28 06:19:06,995 : 
Running out-domain dataset configs.
2024-04-28 06:19:06,995 : {'root_path': '/home/nfs03/zengtc', 'seed': 3407, 'load_cache': False, 'load_pre_feat': False, 'dataset': 'iNaturalist', 'backbone': 'ViT-B/16'}
2024-04-28 06:19:27,948 : **** pos test accuracy: 69.42. ****

2024-04-28 06:19:27,952 : **** neg test accuracy: 57.99. ****

2024-04-28 06:19:27,956 : **** dual test accuracy: 69.03. ****

2024-04-28 06:19:28,328 : **** Our's test pos auroc: 91.72, fpr: 43.48. ****

2024-04-28 06:19:28,694 : **** Our's test neg auroc: 85.33, fpr: 72.20. ****

2024-04-28 06:19:29,062 : **** Our's test dual auroc: 91.38, fpr: 44.93. ****

2024-04-28 06:19:29,070 : **** our dual test accuracy: 69.42. ****

2024-04-28 06:19:29,532 : **** Our's test dual-ours auroc : 92.21, fpr: 42.47. ****

2024-04-28 06:19:29,590 : Train Epoch: 0 / 20
2024-04-28 06:19:54,595 : LR: 0.000994, Acc: 0.6689 (10703.0/16000), Loss: 1.2945
2024-04-28 06:19:54,631 : **** Dual-F's neg test accuracy: 66.75. ****

2024-04-28 06:19:54,632 : Train Epoch: 1 / 20
2024-04-28 06:20:19,505 : LR: 0.000976, Acc: 0.7026 (11241.0/16000), Loss: 1.1597
2024-04-28 06:20:19,542 : **** Dual-F's neg test accuracy: 67.79. ****

2024-04-28 06:20:19,542 : Train Epoch: 2 / 20
2024-04-28 06:20:44,469 : LR: 0.000946, Acc: 0.7242 (11587.0/16000), Loss: 1.0856
2024-04-28 06:20:44,504 : **** Dual-F's neg test accuracy: 68.36. ****

2024-04-28 06:20:44,504 : Train Epoch: 3 / 20
2024-04-28 06:21:09,554 : LR: 0.000905, Acc: 0.7384 (11814.0/16000), Loss: 1.0330
2024-04-28 06:21:09,590 : **** Dual-F's neg test accuracy: 68.88. ****

2024-04-28 06:21:09,590 : Train Epoch: 4 / 20
2024-04-28 06:21:34,694 : LR: 0.000854, Acc: 0.7498 (11996.0/16000), Loss: 0.9878
2024-04-28 06:21:34,729 : **** Dual-F's neg test accuracy: 69.31. ****

2024-04-28 06:21:34,729 : Train Epoch: 5 / 20
2024-04-28 06:21:59,745 : LR: 0.000794, Acc: 0.7681 (12289.0/16000), Loss: 0.9422
2024-04-28 06:21:59,782 : **** Dual-F's neg test accuracy: 69.62. ****

2024-04-28 06:21:59,782 : Train Epoch: 6 / 20
2024-04-28 06:22:24,890 : LR: 0.000727, Acc: 0.7759 (12415.0/16000), Loss: 0.9070
2024-04-28 06:22:24,927 : **** Dual-F's neg test accuracy: 69.73. ****

2024-04-28 06:22:24,927 : Train Epoch: 7 / 20
2024-04-28 06:22:50,167 : LR: 0.000655, Acc: 0.7874 (12598.0/16000), Loss: 0.8732
2024-04-28 06:22:50,204 : **** Dual-F's neg test accuracy: 70.06. ****

2024-04-28 06:22:50,204 : Train Epoch: 8 / 20
2024-04-28 06:23:15,302 : LR: 0.000578, Acc: 0.7907 (12651.0/16000), Loss: 0.8541
2024-04-28 06:23:15,338 : **** Dual-F's neg test accuracy: 70.08. ****

2024-04-28 06:23:15,338 : Train Epoch: 9 / 20
2024-04-28 06:23:40,440 : LR: 0.000500, Acc: 0.7997 (12795.0/16000), Loss: 0.8302
2024-04-28 06:23:40,476 : **** Dual-F's neg test accuracy: 70.26. ****

2024-04-28 06:23:40,476 : Train Epoch: 10 / 20
2024-04-28 06:24:06,236 : LR: 0.000422, Acc: 0.8055 (12888.0/16000), Loss: 0.8111
2024-04-28 06:24:06,271 : **** Dual-F's neg test accuracy: 70.36. ****

2024-04-28 06:24:06,271 : Train Epoch: 11 / 20
2024-04-28 06:24:31,895 : LR: 0.000345, Acc: 0.8140 (13024.0/16000), Loss: 0.7906
2024-04-28 06:24:31,932 : **** Dual-F's neg test accuracy: 70.44. ****

2024-04-28 06:24:31,932 : Train Epoch: 12 / 20
2024-04-28 06:24:57,816 : LR: 0.000273, Acc: 0.8221 (13153.0/16000), Loss: 0.7665
2024-04-28 06:24:57,852 : **** Dual-F's neg test accuracy: 70.47. ****

2024-04-28 06:24:57,852 : Train Epoch: 13 / 20
2024-04-28 06:25:23,261 : LR: 0.000206, Acc: 0.8233 (13173.0/16000), Loss: 0.7676
2024-04-28 06:25:23,297 : **** Dual-F's neg test accuracy: 70.51. ****

2024-04-28 06:25:23,297 : Train Epoch: 14 / 20
2024-04-28 06:25:48,414 : LR: 0.000146, Acc: 0.8253 (13205.0/16000), Loss: 0.7565
2024-04-28 06:25:48,450 : **** Dual-F's neg test accuracy: 70.42. ****

2024-04-28 06:25:48,450 : Train Epoch: 15 / 20
2024-04-28 06:26:13,536 : LR: 0.000095, Acc: 0.8244 (13191.0/16000), Loss: 0.7533
2024-04-28 06:26:13,571 : **** Dual-F's neg test accuracy: 70.54. ****

2024-04-28 06:26:13,571 : Train Epoch: 16 / 20
2024-04-28 06:26:38,815 : LR: 0.000054, Acc: 0.8284 (13255.0/16000), Loss: 0.7504
2024-04-28 06:26:38,852 : **** Dual-F's neg test accuracy: 70.52. ****

2024-04-28 06:26:38,852 : Train Epoch: 17 / 20
2024-04-28 06:27:04,108 : LR: 0.000024, Acc: 0.8258 (13213.0/16000), Loss: 0.7490
2024-04-28 06:27:04,143 : **** Dual-F's neg test accuracy: 70.53. ****

2024-04-28 06:27:04,144 : Train Epoch: 18 / 20
2024-04-28 06:27:29,148 : LR: 0.000006, Acc: 0.8314 (13303.0/16000), Loss: 0.7440
2024-04-28 06:27:29,186 : **** Dual-F's neg test accuracy: 70.53. ****

2024-04-28 06:27:29,186 : Train Epoch: 19 / 20
2024-04-28 06:28:29,660 : LR: 0.000000, Acc: 0.8308 (13293.0/16000), Loss: 0.7437
2024-04-28 06:28:29,697 : **** Dual-F's neg test accuracy: 70.53. ****

2024-04-28 06:28:29,697 : Train Epoch: 0 / 20
2024-04-28 06:29:24,078 : LR: 0.000994, Acc: 0.7082 (11331.0/16000), Loss: 1.0838
2024-04-28 06:29:24,121 : **** Dual-F's pos test accuracy: 70.40. ****

2024-04-28 06:29:24,121 : Train Epoch: 1 / 20
2024-04-28 06:30:07,446 : LR: 0.000976, Acc: 0.7217 (11547.0/16000), Loss: 1.0280
2024-04-28 06:30:07,490 : **** Dual-F's pos test accuracy: 70.99. ****

2024-04-28 06:30:07,490 : Train Epoch: 2 / 20
2024-04-28 06:30:32,632 : LR: 0.000946, Acc: 0.7274 (11638.0/16000), Loss: 0.9959
2024-04-28 06:30:32,675 : **** Dual-F's pos test accuracy: 71.31. ****

2024-04-28 06:30:32,675 : Train Epoch: 3 / 20
2024-04-28 06:30:57,681 : LR: 0.000905, Acc: 0.7398 (11836.0/16000), Loss: 0.9638
2024-04-28 06:30:57,724 : **** Dual-F's pos test accuracy: 71.53. ****

2024-04-28 06:30:57,725 : Train Epoch: 4 / 20
2024-04-28 06:31:22,743 : LR: 0.000854, Acc: 0.7446 (11914.0/16000), Loss: 0.9409
2024-04-28 06:31:22,786 : **** Dual-F's pos test accuracy: 71.70. ****

2024-04-28 06:31:22,786 : Train Epoch: 5 / 20
2024-04-28 06:31:47,972 : LR: 0.000794, Acc: 0.7499 (11999.0/16000), Loss: 0.9110
2024-04-28 06:31:48,016 : **** Dual-F's pos test accuracy: 71.89. ****

2024-04-28 06:31:48,016 : Train Epoch: 6 / 20
2024-04-28 06:32:13,083 : LR: 0.000727, Acc: 0.7562 (12099.0/16000), Loss: 0.9064
2024-04-28 06:32:13,127 : **** Dual-F's pos test accuracy: 72.01. ****

2024-04-28 06:32:13,127 : Train Epoch: 7 / 20
2024-04-28 06:32:38,186 : LR: 0.000655, Acc: 0.7599 (12159.0/16000), Loss: 0.8819
2024-04-28 06:32:38,229 : **** Dual-F's pos test accuracy: 72.03. ****

2024-04-28 06:32:38,229 : Train Epoch: 8 / 20
2024-04-28 06:33:03,264 : LR: 0.000578, Acc: 0.7621 (12193.0/16000), Loss: 0.8747
2024-04-28 06:33:03,308 : **** Dual-F's pos test accuracy: 72.11. ****

2024-04-28 06:33:03,308 : Train Epoch: 9 / 20
2024-04-28 06:33:28,413 : LR: 0.000500, Acc: 0.7650 (12240.0/16000), Loss: 0.8621
2024-04-28 06:33:28,457 : **** Dual-F's pos test accuracy: 72.21. ****

2024-04-28 06:33:28,458 : Train Epoch: 10 / 20
2024-04-28 06:33:53,723 : LR: 0.000422, Acc: 0.7715 (12344.0/16000), Loss: 0.8500
2024-04-28 06:33:53,766 : **** Dual-F's pos test accuracy: 72.24. ****

2024-04-28 06:33:53,766 : Train Epoch: 11 / 20
2024-04-28 06:34:18,918 : LR: 0.000345, Acc: 0.7749 (12398.0/16000), Loss: 0.8357
2024-04-28 06:34:18,963 : **** Dual-F's pos test accuracy: 72.28. ****

2024-04-28 06:34:18,963 : Train Epoch: 12 / 20
2024-04-28 06:34:43,926 : LR: 0.000273, Acc: 0.7749 (12398.0/16000), Loss: 0.8360
2024-04-28 06:34:43,970 : **** Dual-F's pos test accuracy: 72.31. ****

2024-04-28 06:34:43,970 : Train Epoch: 13 / 20
2024-04-28 06:35:09,234 : LR: 0.000206, Acc: 0.7787 (12459.0/16000), Loss: 0.8289
2024-04-28 06:35:09,277 : **** Dual-F's pos test accuracy: 72.32. ****

2024-04-28 06:35:09,277 : Train Epoch: 14 / 20
2024-04-28 06:35:34,451 : LR: 0.000146, Acc: 0.7756 (12410.0/16000), Loss: 0.8316
2024-04-28 06:35:34,494 : **** Dual-F's pos test accuracy: 72.32. ****

2024-04-28 06:35:34,494 : Train Epoch: 15 / 20
2024-04-28 06:35:59,698 : LR: 0.000095, Acc: 0.7781 (12449.0/16000), Loss: 0.8271
2024-04-28 06:35:59,741 : **** Dual-F's pos test accuracy: 72.32. ****

2024-04-28 06:35:59,742 : Train Epoch: 16 / 20
2024-04-28 06:36:24,797 : LR: 0.000054, Acc: 0.7790 (12464.0/16000), Loss: 0.8248
2024-04-28 06:36:24,841 : **** Dual-F's pos test accuracy: 72.33. ****

2024-04-28 06:36:24,841 : Train Epoch: 17 / 20
2024-04-28 06:36:49,959 : LR: 0.000024, Acc: 0.7761 (12418.0/16000), Loss: 0.8280
2024-04-28 06:36:50,002 : **** Dual-F's pos test accuracy: 72.33. ****

2024-04-28 06:36:50,002 : Train Epoch: 18 / 20
2024-04-28 06:37:15,238 : LR: 0.000006, Acc: 0.7801 (12481.0/16000), Loss: 0.8205
2024-04-28 06:37:15,283 : **** Dual-F's pos test accuracy: 72.33. ****

2024-04-28 06:37:15,283 : Train Epoch: 19 / 20
2024-04-28 06:37:40,585 : LR: 0.000000, Acc: 0.7779 (12447.0/16000), Loss: 0.8240
2024-04-28 06:37:40,628 : **** Dual-F's pos test accuracy: 72.33. ****

2024-04-28 06:37:40,703 : **** Dual's pos test accuracy: 72.33. ****

2024-04-28 06:37:40,706 : **** Dual's neg test accuracy: 70.53. ****

2024-04-28 06:37:40,710 : **** Dual's dual test accuracy: 72.72. ****

2024-04-28 06:37:41,108 : **** Our's test pos auroc: 92.34, fpr: 39.06. ****

2024-04-28 06:37:41,474 : **** Our's test neg auroc: 94.05, fpr: 27.21. ****

2024-04-28 06:37:41,840 : **** Our's test dual auroc: 93.65, fpr: 31.59. ****

2024-04-28 06:37:42,312 : **** Our's test dual-ours auroc : 93.95, fpr: 29.96. ****

