2024-04-29 13:13:29,651 : #########TRAIN_EVAL_INFO############
2024-04-29 13:13:29,655 : 
Running in-domain dataset configs.
2024-04-29 13:13:29,656 : {'root_path': '/home/nfs03/liyh/', 'seed': 3407, 'load_cache': True, 'load_pre_feat': True, 'search_hp': True, 'search_scale': [30, 30, 60], 'search_step': [200, 30, 40], 'init_beta': 1, 'init_alpha': 2, 'init_gamma': 0.1, 'eps': 0.001, 'training_feat_num': 256, 'training_free_feat_num': 256, 'w_training_free': [0.7, 0.3], 'w_training': [0.2, 0.8], 'dataset': 'imagenet', 'shots': 16, 'backbone': 'ViT-B/16', 'lr': 0.001, 'augment_epoch': 10, 'train_epoch': 20, 'data_section': 0, 'cache_dir': '/home/nfs03/zengtc/tip/caches/imagenet'}
2024-04-29 13:13:35,674 : Preparing ImageNet dataset.
2024-04-29 13:16:01,293 : Getting textual features as CLIP's classifier.
2024-04-29 13:16:17,929 : 
Constructing cache model by few-shot visual features and labels.
2024-04-29 13:16:18,058 : 
Loading visual features and labels from test set.
2024-04-29 13:16:18,086 : 
Running out-domain dataset configs.
2024-04-29 13:16:18,087 : {'root_path': '/home/nfs03/zengtc', 'load_cache': False, 'load_pre_feat': False, 'dataset': 'Texture', 'backbone': 'ViT-B/16'}
2024-04-29 13:16:27,613 : **** pos test accuracy: 68.76. ****

2024-04-29 13:16:27,617 : **** neg test(-) accuracy: 0.00. ****

2024-04-29 13:16:27,620 : **** neg test(+) accuracy: 62.30. ****

2024-04-29 13:16:27,624 : **** dual test accuracy: 19.59. ****

2024-04-29 13:16:27,945 : **** Our's test pos auroc: 87.82, fpr: 52.93. ****

2024-04-29 13:16:28,229 : **** Our's test neg(-) auroc: 72.49, fpr: 81.90. ****

2024-04-29 13:16:28,571 : **** Our's test neg(+) auroc: 88.55, fpr: 47.64. ****

2024-04-29 13:16:28,909 : **** Our's test dual auroc: 72.02, fpr: 81.72. ****

2024-04-29 13:16:29,337 : **** Our's test dual-ours auroc : 89.74, fpr: 46.83. ****

2024-04-29 13:16:29,391 : Train Epoch: 0 / 20
2024-04-29 13:16:54,310 : LR: 0.000994, Acc: 0.6944 (11110.0/16000), Loss: 1.1363
2024-04-29 13:16:54,353 : **** Dual-F's pos test accuracy: 70.31. ****

2024-04-29 13:16:54,353 : Train Epoch: 1 / 20
2024-04-29 13:17:19,213 : LR: 0.000976, Acc: 0.7079 (11327.0/16000), Loss: 1.0818
2024-04-29 13:17:19,256 : **** Dual-F's pos test accuracy: 70.57. ****

2024-04-29 13:17:19,257 : Train Epoch: 2 / 20
2024-04-29 13:17:44,204 : LR: 0.000946, Acc: 0.7157 (11452.0/16000), Loss: 1.0485
2024-04-29 13:17:44,247 : **** Dual-F's pos test accuracy: 70.75. ****

2024-04-29 13:17:44,247 : Train Epoch: 3 / 20
2024-04-29 13:18:09,243 : LR: 0.000905, Acc: 0.7204 (11526.0/16000), Loss: 1.0246
2024-04-29 13:18:09,286 : **** Dual-F's pos test accuracy: 71.18. ****

2024-04-29 13:18:09,286 : Train Epoch: 4 / 20
2024-04-29 13:18:34,358 : LR: 0.000854, Acc: 0.7297 (11675.0/16000), Loss: 1.0008
2024-04-29 13:18:34,401 : **** Dual-F's pos test accuracy: 71.38. ****

2024-04-29 13:18:34,401 : Train Epoch: 5 / 20
2024-04-29 13:18:59,316 : LR: 0.000794, Acc: 0.7354 (11767.0/16000), Loss: 0.9735
2024-04-29 13:18:59,360 : **** Dual-F's pos test accuracy: 71.54. ****

2024-04-29 13:18:59,360 : Train Epoch: 6 / 20
2024-04-29 13:19:27,818 : LR: 0.000727, Acc: 0.7436 (11897.0/16000), Loss: 0.9492
2024-04-29 13:19:27,861 : **** Dual-F's pos test accuracy: 71.64. ****

2024-04-29 13:19:27,861 : Train Epoch: 7 / 20
2024-04-29 13:19:53,091 : LR: 0.000655, Acc: 0.7502 (12003.0/16000), Loss: 0.9309
2024-04-29 13:19:53,134 : **** Dual-F's pos test accuracy: 71.75. ****

2024-04-29 13:19:53,134 : Train Epoch: 8 / 20
2024-04-29 13:20:18,202 : LR: 0.000578, Acc: 0.7495 (11992.0/16000), Loss: 0.9190
2024-04-29 13:20:18,245 : **** Dual-F's pos test accuracy: 71.87. ****

2024-04-29 13:20:18,245 : Train Epoch: 9 / 20
2024-04-29 13:20:43,276 : LR: 0.000500, Acc: 0.7556 (12090.0/16000), Loss: 0.8991
2024-04-29 13:20:43,319 : **** Dual-F's pos test accuracy: 71.88. ****

2024-04-29 13:20:43,320 : Train Epoch: 10 / 20
2024-04-29 13:21:08,379 : LR: 0.000422, Acc: 0.7624 (12199.0/16000), Loss: 0.8830
2024-04-29 13:21:08,422 : **** Dual-F's pos test accuracy: 72.18. ****

2024-04-29 13:21:08,422 : Train Epoch: 11 / 20
2024-04-29 13:21:33,475 : LR: 0.000345, Acc: 0.7671 (12274.0/16000), Loss: 0.8706
2024-04-29 13:21:33,518 : **** Dual-F's pos test accuracy: 72.14. ****

2024-04-29 13:21:33,519 : Train Epoch: 12 / 20
2024-04-29 13:22:07,595 : LR: 0.000273, Acc: 0.7724 (12359.0/16000), Loss: 0.8494
2024-04-29 13:22:07,638 : **** Dual-F's pos test accuracy: 72.15. ****

2024-04-29 13:22:07,638 : Train Epoch: 13 / 20
2024-04-29 13:22:40,153 : LR: 0.000206, Acc: 0.7729 (12367.0/16000), Loss: 0.8549
2024-04-29 13:22:40,196 : **** Dual-F's pos test accuracy: 72.16. ****

2024-04-29 13:22:40,196 : Train Epoch: 14 / 20
2024-04-29 13:23:14,076 : LR: 0.000146, Acc: 0.7748 (12396.0/16000), Loss: 0.8434
2024-04-29 13:23:14,119 : **** Dual-F's pos test accuracy: 72.22. ****

2024-04-29 13:23:14,119 : Train Epoch: 15 / 20
2024-04-29 13:24:06,187 : LR: 0.000095, Acc: 0.7726 (12361.0/16000), Loss: 0.8429
2024-04-29 13:24:06,230 : **** Dual-F's pos test accuracy: 72.21. ****

2024-04-29 13:24:06,230 : Train Epoch: 16 / 20
2024-04-29 13:24:45,257 : LR: 0.000054, Acc: 0.7790 (12464.0/16000), Loss: 0.8376
2024-04-29 13:24:45,300 : **** Dual-F's pos test accuracy: 72.23. ****

2024-04-29 13:24:45,300 : Train Epoch: 17 / 20
2024-04-29 13:25:21,590 : LR: 0.000024, Acc: 0.7774 (12438.0/16000), Loss: 0.8357
2024-04-29 13:25:21,633 : **** Dual-F's pos test accuracy: 72.24. ****

2024-04-29 13:25:21,633 : Train Epoch: 18 / 20
2024-04-29 13:25:54,608 : LR: 0.000006, Acc: 0.7793 (12469.0/16000), Loss: 0.8327
2024-04-29 13:25:54,651 : **** Dual-F's pos test accuracy: 72.27. ****

2024-04-29 13:25:54,652 : Train Epoch: 19 / 20
2024-04-29 13:26:20,035 : LR: 0.000000, Acc: 0.7802 (12484.0/16000), Loss: 0.8292
2024-04-29 13:26:20,079 : **** Dual-F's pos test accuracy: 72.27. ****

2024-04-29 13:26:20,161 : **** Dual's pos test accuracy: 72.27. ****

2024-04-29 13:26:20,164 : **** Dual's neg test accuracy: 62.30. ****

2024-04-29 13:26:20,168 : **** Dual's dual test accuracy: 69.40. ****

2024-04-29 13:26:20,526 : **** Our's test pos auroc: 86.50, fpr: 55.32. ****

2024-04-29 13:26:20,869 : **** Our's test neg auroc: 88.55, fpr: 47.64. ****

2024-04-29 13:26:21,212 : **** Our's test dual auroc: 87.98, fpr: 50.51. ****

2024-04-29 13:26:21,647 : **** Our's test dual-ours auroc : 88.54, fpr: 47.77. ****

