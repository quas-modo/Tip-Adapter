2024-04-29 07:14:50,017 : #########TRAIN_EVAL_INFO############
2024-04-29 07:14:50,018 : 
Running in-domain dataset configs.
2024-04-29 07:14:50,019 : {'root_path': '/home/nfs03/liyh/', 'seed': 3407, 'load_cache': True, 'load_pre_feat': True, 'search_hp': True, 'search_scale': [30, 30, 60], 'search_step': [200, 30, 40], 'init_beta': 1, 'init_alpha': 2, 'init_gamma': 0.1, 'eps': 0.001, 'training_feat_num': 256, 'training_free_feat_num': 256, 'w_training_free': [0.7, 0.3], 'w_training': [0.2, 0.8], 'dataset': 'imagenet', 'shots': 16, 'backbone': 'ViT-B/16', 'lr': 0.001, 'augment_epoch': 10, 'train_epoch': 20, 'data_section': 0, 'cache_dir': '/home/nfs03/zengtc/tip/caches/imagenet'}
2024-04-29 07:14:56,082 : Preparing ImageNet dataset.
2024-04-29 07:17:10,994 : Getting textual features as CLIP's classifier.
2024-04-29 07:17:27,638 : 
Constructing cache model by few-shot visual features and labels.
2024-04-29 07:17:27,791 : 
Loading visual features and labels from test set.
2024-04-29 07:17:27,819 : 
Running out-domain dataset configs.
2024-04-29 07:17:27,819 : {'root_path': '/home/nfs03/zengtc', 'load_cache': False, 'load_pre_feat': False, 'dataset': 'Texture', 'backbone': 'ViT-B/16'}
2024-04-29 07:17:38,934 : Train Epoch: 0 / 20
2024-04-29 07:18:03,873 : LR: 0.000994, Acc: 0.6502 (10404.0/16000), Loss: 1.4237
2024-04-29 07:18:03,919 : **** Dual-F's neg test accuracy: 67.12. ****

2024-04-29 07:18:03,919 : Train Epoch: 1 / 20
2024-04-29 07:18:28,873 : LR: 0.000976, Acc: 0.6751 (10802.0/16000), Loss: 1.3257
2024-04-29 07:18:28,916 : **** Dual-F's neg test accuracy: 67.92. ****

2024-04-29 07:18:28,917 : Train Epoch: 2 / 20
2024-04-29 07:18:53,812 : LR: 0.000946, Acc: 0.6883 (11012.0/16000), Loss: 1.2678
2024-04-29 07:18:53,855 : **** Dual-F's neg test accuracy: 68.34. ****

2024-04-29 07:18:53,856 : Train Epoch: 3 / 20
2024-04-29 07:19:18,993 : LR: 0.000905, Acc: 0.6991 (11185.0/16000), Loss: 1.2265
2024-04-29 07:19:19,036 : **** Dual-F's neg test accuracy: 69.00. ****

2024-04-29 07:19:19,036 : Train Epoch: 4 / 20
2024-04-29 07:19:44,191 : LR: 0.000854, Acc: 0.7134 (11414.0/16000), Loss: 1.1863
2024-04-29 07:19:44,234 : **** Dual-F's neg test accuracy: 69.31. ****

2024-04-29 07:19:44,235 : Train Epoch: 5 / 20
2024-04-29 07:20:09,316 : LR: 0.000794, Acc: 0.7207 (11531.0/16000), Loss: 1.1453
2024-04-29 07:20:09,359 : **** Dual-F's neg test accuracy: 69.75. ****

2024-04-29 07:20:09,359 : Train Epoch: 6 / 20
2024-04-29 07:20:34,717 : LR: 0.000727, Acc: 0.7340 (11744.0/16000), Loss: 1.1090
2024-04-29 07:20:34,760 : **** Dual-F's neg test accuracy: 69.90. ****

2024-04-29 07:20:34,760 : Train Epoch: 7 / 20
2024-04-29 07:21:00,221 : LR: 0.000655, Acc: 0.7426 (11881.0/16000), Loss: 1.0789
2024-04-29 07:21:00,264 : **** Dual-F's neg test accuracy: 70.15. ****

2024-04-29 07:21:00,264 : Train Epoch: 8 / 20
2024-04-29 07:21:25,255 : LR: 0.000578, Acc: 0.7459 (11934.0/16000), Loss: 1.0595
2024-04-29 07:21:25,298 : **** Dual-F's neg test accuracy: 70.35. ****

2024-04-29 07:21:25,298 : Train Epoch: 9 / 20
2024-04-29 07:21:50,401 : LR: 0.000500, Acc: 0.7520 (12032.0/16000), Loss: 1.0335
2024-04-29 07:21:50,444 : **** Dual-F's neg test accuracy: 70.49. ****

2024-04-29 07:21:50,445 : Train Epoch: 10 / 20
2024-04-29 07:22:15,503 : LR: 0.000422, Acc: 0.7634 (12214.0/16000), Loss: 1.0123
2024-04-29 07:22:15,546 : **** Dual-F's neg test accuracy: 70.71. ****

2024-04-29 07:22:15,546 : Train Epoch: 11 / 20
2024-04-29 07:22:40,561 : LR: 0.000345, Acc: 0.7661 (12257.0/16000), Loss: 0.9925
2024-04-29 07:22:40,604 : **** Dual-F's neg test accuracy: 70.80. ****

2024-04-29 07:22:40,605 : Train Epoch: 12 / 20
2024-04-29 07:23:05,792 : LR: 0.000273, Acc: 0.7753 (12405.0/16000), Loss: 0.9675
2024-04-29 07:23:05,835 : **** Dual-F's neg test accuracy: 70.82. ****

2024-04-29 07:23:05,836 : Train Epoch: 13 / 20
2024-04-29 07:23:31,143 : LR: 0.000206, Acc: 0.7746 (12393.0/16000), Loss: 0.9680
2024-04-29 07:23:31,186 : **** Dual-F's neg test accuracy: 70.80. ****

2024-04-29 07:23:31,186 : Train Epoch: 14 / 20
2024-04-29 07:23:56,307 : LR: 0.000146, Acc: 0.7791 (12465.0/16000), Loss: 0.9549
2024-04-29 07:23:56,350 : **** Dual-F's neg test accuracy: 70.80. ****

2024-04-29 07:23:56,350 : Train Epoch: 15 / 20
2024-04-29 07:24:21,503 : LR: 0.000095, Acc: 0.7759 (12414.0/16000), Loss: 0.9534
2024-04-29 07:24:21,546 : **** Dual-F's neg test accuracy: 70.84. ****

2024-04-29 07:24:21,546 : Train Epoch: 16 / 20
2024-04-29 07:24:46,736 : LR: 0.000054, Acc: 0.7788 (12461.0/16000), Loss: 0.9476
2024-04-29 07:24:46,779 : **** Dual-F's neg test accuracy: 70.88. ****

2024-04-29 07:24:46,779 : Train Epoch: 17 / 20
2024-04-29 07:25:12,016 : LR: 0.000024, Acc: 0.7783 (12453.0/16000), Loss: 0.9457
2024-04-29 07:25:12,059 : **** Dual-F's neg test accuracy: 70.88. ****

2024-04-29 07:25:12,059 : Train Epoch: 18 / 20
2024-04-29 07:25:37,390 : LR: 0.000006, Acc: 0.7833 (12533.0/16000), Loss: 0.9405
2024-04-29 07:25:37,433 : **** Dual-F's neg test accuracy: 70.87. ****

2024-04-29 07:25:37,434 : Train Epoch: 19 / 20
2024-04-29 07:26:02,602 : LR: 0.000000, Acc: 0.7818 (12509.0/16000), Loss: 0.9387
2024-04-29 07:26:02,644 : **** Dual-F's neg test accuracy: 70.87. ****

2024-04-29 07:26:02,645 : Train Epoch: 0 / 20
2024-04-29 07:26:27,798 : LR: 0.000994, Acc: 0.6912 (11059.0/16000), Loss: 1.1494
2024-04-29 07:26:27,841 : **** Dual-F's pos test accuracy: 70.17. ****

2024-04-29 07:26:27,842 : Train Epoch: 1 / 20
2024-04-29 07:26:52,994 : LR: 0.000976, Acc: 0.7073 (11316.0/16000), Loss: 1.0791
2024-04-29 07:26:53,037 : **** Dual-F's pos test accuracy: 70.68. ****

2024-04-29 07:26:53,037 : Train Epoch: 2 / 20
2024-04-29 07:27:18,219 : LR: 0.000946, Acc: 0.7151 (11442.0/16000), Loss: 1.0530
2024-04-29 07:27:18,262 : **** Dual-F's pos test accuracy: 70.93. ****

2024-04-29 07:27:18,262 : Train Epoch: 3 / 20
2024-04-29 07:27:43,367 : LR: 0.000905, Acc: 0.7209 (11535.0/16000), Loss: 1.0200
2024-04-29 07:27:43,409 : **** Dual-F's pos test accuracy: 71.24. ****

2024-04-29 07:27:43,410 : Train Epoch: 4 / 20
2024-04-29 07:28:08,443 : LR: 0.000854, Acc: 0.7308 (11692.0/16000), Loss: 0.9950
2024-04-29 07:28:08,486 : **** Dual-F's pos test accuracy: 71.38. ****

2024-04-29 07:28:08,486 : Train Epoch: 5 / 20
2024-04-29 07:28:33,897 : LR: 0.000794, Acc: 0.7371 (11793.0/16000), Loss: 0.9629
2024-04-29 07:28:33,940 : **** Dual-F's pos test accuracy: 71.51. ****

2024-04-29 07:28:33,940 : Train Epoch: 6 / 20
2024-04-29 07:28:59,292 : LR: 0.000727, Acc: 0.7412 (11860.0/16000), Loss: 0.9529
2024-04-29 07:28:59,334 : **** Dual-F's pos test accuracy: 71.67. ****

2024-04-29 07:28:59,335 : Train Epoch: 7 / 20
2024-04-29 07:29:24,409 : LR: 0.000655, Acc: 0.7498 (11996.0/16000), Loss: 0.9241
2024-04-29 07:29:24,453 : **** Dual-F's pos test accuracy: 71.77. ****

2024-04-29 07:29:24,453 : Train Epoch: 8 / 20
2024-04-29 07:29:49,554 : LR: 0.000578, Acc: 0.7536 (12058.0/16000), Loss: 0.9126
2024-04-29 07:29:49,597 : **** Dual-F's pos test accuracy: 71.90. ****

2024-04-29 07:29:49,597 : Train Epoch: 9 / 20
2024-04-29 07:30:14,969 : LR: 0.000500, Acc: 0.7567 (12107.0/16000), Loss: 0.8976
2024-04-29 07:30:15,012 : **** Dual-F's pos test accuracy: 71.92. ****

2024-04-29 07:30:15,012 : Train Epoch: 10 / 20
2024-04-29 07:30:40,580 : LR: 0.000422, Acc: 0.7631 (12210.0/16000), Loss: 0.8809
2024-04-29 07:30:40,623 : **** Dual-F's pos test accuracy: 72.01. ****

2024-04-29 07:30:40,623 : Train Epoch: 11 / 20
2024-04-29 07:31:06,011 : LR: 0.000345, Acc: 0.7680 (12288.0/16000), Loss: 0.8631
2024-04-29 07:31:06,054 : **** Dual-F's pos test accuracy: 72.05. ****

2024-04-29 07:31:06,055 : Train Epoch: 12 / 20
2024-04-29 07:31:31,181 : LR: 0.000273, Acc: 0.7686 (12298.0/16000), Loss: 0.8599
2024-04-29 07:31:31,224 : **** Dual-F's pos test accuracy: 72.13. ****

2024-04-29 07:31:31,224 : Train Epoch: 13 / 20
2024-04-29 07:31:56,400 : LR: 0.000206, Acc: 0.7752 (12403.0/16000), Loss: 0.8501
2024-04-29 07:31:56,443 : **** Dual-F's pos test accuracy: 72.30. ****

2024-04-29 07:31:56,444 : Train Epoch: 14 / 20
2024-04-29 07:32:21,606 : LR: 0.000146, Acc: 0.7721 (12353.0/16000), Loss: 0.8505
2024-04-29 07:32:21,650 : **** Dual-F's pos test accuracy: 72.24. ****

2024-04-29 07:32:21,650 : Train Epoch: 15 / 20
2024-04-29 07:32:46,791 : LR: 0.000095, Acc: 0.7776 (12441.0/16000), Loss: 0.8430
2024-04-29 07:32:46,834 : **** Dual-F's pos test accuracy: 72.25. ****

2024-04-29 07:32:46,835 : Train Epoch: 16 / 20
2024-04-29 07:33:11,900 : LR: 0.000054, Acc: 0.7754 (12407.0/16000), Loss: 0.8372
2024-04-29 07:33:11,943 : **** Dual-F's pos test accuracy: 72.27. ****

2024-04-29 07:33:11,943 : Train Epoch: 17 / 20
2024-04-29 07:33:36,989 : LR: 0.000024, Acc: 0.7752 (12403.0/16000), Loss: 0.8392
2024-04-29 07:33:37,031 : **** Dual-F's pos test accuracy: 72.29. ****

2024-04-29 07:33:37,032 : Train Epoch: 18 / 20
2024-04-29 07:34:02,023 : LR: 0.000006, Acc: 0.7789 (12463.0/16000), Loss: 0.8308
2024-04-29 07:34:02,066 : **** Dual-F's pos test accuracy: 72.28. ****

2024-04-29 07:34:02,067 : Train Epoch: 19 / 20
2024-04-29 07:34:26,977 : LR: 0.000000, Acc: 0.7778 (12444.0/16000), Loss: 0.8349
2024-04-29 07:34:27,020 : **** Dual-F's pos test accuracy: 72.28. ****

2024-04-29 07:34:27,102 : **** Dual's pos test accuracy: 72.28. ****

2024-04-29 07:34:27,105 : **** Dual's neg test accuracy: 70.87. ****

2024-04-29 07:34:27,109 : **** Dual's dual test accuracy: 72.08. ****

2024-04-29 07:34:27,446 : **** Our's test pos auroc: 86.50, fpr: 55.28. ****

2024-04-29 07:34:27,800 : **** Our's test neg auroc: 87.06, fpr: 50.59. ****

2024-04-29 07:34:28,156 : **** Our's test dual auroc: 86.99, fpr: 51.67. ****

2024-04-29 07:34:28,605 : **** Our's test dual-ours auroc : 87.76, fpr: 50.98. ****

